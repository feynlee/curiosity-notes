<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ziyue li">
<meta name="dcterms.date" content="2022-12-23">
<meta name="description" content="A physics study of eclipse by a gas giant seen from its moon.">

<title>curiosity-notes - Eclipse on Pandora and the Orbital Physics in Avatar</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-343667243"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-343667243', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=637e822e04255c001315118d&amp;product=inline-share-buttons&amp;source=platform" async="async"></script>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="v97khzznr8B" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="curiosity-notes - Eclipse on Pandora and the Orbital Physics in Avatar">
<meta property="og:description" content="A physics study of eclipse by a gas giant seen from its moon.">
<meta property="og:image" content="https://feynlee.github.io/curiosity-notes/posts/images/2022/pandora_night.jpg">
<meta property="og:site-name" content="curiosity-notes">
<meta name="twitter:title" content="curiosity-notes - Eclipse on Pandora and the Orbital Physics in Avatar">
<meta name="twitter:description" content="A physics study of eclipse by a gas giant seen from its moon.">
<meta name="twitter:image" content="https://feynlee.github.io/curiosity-notes/posts/images/2022/pandora_night.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">curiosity-notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../TIL.html" rel="" target="">
 <span class="menu-text">TIL</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../books/books.html" rel="" target="">
 <span class="menu-text">Books</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ai-art" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">AI Art</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ai-art">    
        <li>
    <a class="dropdown-item" href="../ai_art-sd.html" rel="" target="">
 <span class="dropdown-text">Stable Diffusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ai_art-dd.html" rel="" target="">
 <span class="dropdown-text">Disco Diffusion</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Apps/Long-Text-Pic.html" rel="" target="">
 <span class="menu-text">Apps</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/feynlee" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/curiosity_notes" rel="" target=""><i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-rss" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-rss">    
        <li>
    <a class="dropdown-item" href="https://feynlee.github.io/curiosity-notes/index.xml" rel="" target=""><i class="bi bi-rss" role="img" aria-label="Posts RSS">
</i> 
 <span class="dropdown-text">Subscribe to Posts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://feynlee.github.io/curiosity-notes/TIL.xml" rel="" target=""><i class="bi bi-rss" role="img" aria-label="TIL RSS">
</i> 
 <span class="dropdown-text">Subscribe to TIL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://feynlee.github.io/curiosity-notes/projects.xml" rel="" target=""><i class="bi bi-rss" role="img" aria-label="Projects RSS">
</i> 
 <span class="dropdown-text">Subscribe to Projects</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Eclipse on Pandora and the Orbital Physics in Avatar</h1>
                  <div>
        <div class="description">
          A physics study of eclipse by a gas giant seen from its moon.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Physics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>ziyue li </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 23, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#eclipse-on-pandora" id="toc-eclipse-on-pandora" class="nav-link active" data-scroll-target="#eclipse-on-pandora">Eclipse on Pandora</a></li>
  <li><a href="#orbital-period" id="toc-orbital-period" class="nav-link" data-scroll-target="#orbital-period">Orbital Period</a></li>
  <li><a href="#eclipse-duration" id="toc-eclipse-duration" class="nav-link" data-scroll-target="#eclipse-duration">Eclipse Duration</a></li>
  <li><a href="#information-on-astronomy-of-pandora" id="toc-information-on-astronomy-of-pandora" class="nav-link" data-scroll-target="#information-on-astronomy-of-pandora">Information on Astronomy of Pandora</a></li>
  <li><a href="#rotation-of-pandora" id="toc-rotation-of-pandora" class="nav-link" data-scroll-target="#rotation-of-pandora">Rotation of Pandora</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul>
  <li><a href="#shadow-size-of-the-gas-giant" id="toc-shadow-size-of-the-gas-giant" class="nav-link" data-scroll-target="#shadow-size-of-the-gas-giant">Shadow Size of the Gas Giant</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="eclipse-on-pandora" class="level1">
<h1>Eclipse on Pandora</h1>
<p>After watching <a href="https://en.wikipedia.org/wiki/Avatar:_The_Way_of_Water">Avatar: The Way of Water</a>, I’m quite intrigued by the eclipse in the movie. The sun is blocked by the gas giant for what appears to be a couple of hours, which seems to make sense if you assume that the sun travels across the sky in a similar amount of time as what we experience on Earth.</p>
<p>However, on a deeper thought, the situation here is more complicated than that.</p>
<p>The fact that we have sunrise and sunset on Earth is because of the Earth’s rotation, and the eclipse only lasts a short while because the moon is very small in the sky, and its shadow does not cover the whole Earth.</p>
<p>But on Pandora, the gas giant it’s orbiting around is much bigger, and if we use Jupiter and its moons as a reference, then the shadow of the gas giant is probably bigger than Pandora. In that case, the spinning of Pandora does not get it out of the “shadow zone”. It can only get out of the shadow when Pandora travels across the gas giant’s shadow.</p>
<p>So now the question is, in this case, is it possible that the Eclipse only lasts a few hours? Here’s my analysis of this system, with some of the simplest assumptions</p>
</section>
<section id="orbital-period" class="level1">
<h1>Orbital Period</h1>
<p>From the balance of centripetal force and gravitational force: <span class="math display">\[m\frac{v^2}{r}=G\frac{mM}{r^2}\]</span></p>
<p>we have the velocity of the planet Pandora around the gas giant: <span class="math display">\[v=\sqrt{\frac{GM}{r}}\]</span></p>
<p>Therefore the period of the orbit is <span class="math display">\[T=2\pi r/v=2\pi\sqrt{\frac{r^3}{GM}}\]</span></p>
<p>We don’t know the mass of the gas giant in the movie, but we do have reference for how big the gas giant looks like from Pandora, which gives us an estimate of the ratio of the size of the gas giant to the distance between Pandora and the gas giant, as will be explained below.</p>
<p>So we rewrite the mass as a function of the gas giant’s size: <span class="math inline">\(M=4\pi R^3/3*\rho\)</span>, and get <span class="math display">\[T=2\pi \sqrt{\frac{r^3}{R^3}}\sqrt{\frac{3}{4\pi G \rho}}\]</span></p>
<p>Besides the ratio of <span class="math inline">\(r/R\)</span>, it only depends on the density of the Gas Giant.</p>
<ul>
<li><p>Estimation of <span class="math inline">\(r/R\)</span></p>
<p>The arc length extended by the gas giant in Pandora’s sky is approximately its diameter <span class="math inline">\(2R\)</span> (we are only doing estimations here). Dividing that by half the circumference of the orbit gives us the ratio of the angular size <span class="math inline">\(\delta\)</span> to <span class="math inline">\(\pi\)</span>: <span class="math display">\[\frac{\delta}{\pi}\approx\frac{2R}{\pi r},\]</span></p>
<p>From some shots in the movie, we can get a sense of how big the gas giant looks like from Pandora.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2022/angular_size_measurement.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
<p>In the shot above, if we take the smaller planet (circled) as having the same angular size as the sun seen from the Earth (<span class="math inline">\(0.53^{\circ}\)</span>), then a rough measurement shows that the apparent size of the gas giant is about 22 times <span class="math display">\[\delta = 22 * 0.53^{\circ} \approx 11^{\circ} \approx \frac{\pi}{18} \]</span></p>
<p>To get better estimation, let’s take a range. Let’s say that that the gas giants fills up <span class="math inline">\(\frac{1}{18}\)</span> to <span class="math inline">\(\frac{1}{9}\)</span> of the sky, i.e.&nbsp;<span class="math inline">\(\frac{1}{18}\lt\delta/\pi\lt\frac{1}{9}\)</span>, then we have <span class="math display">\[\frac{1}{11.5} \approx \frac{\pi}{2}\frac{1}{18} \lesssim \frac{R}{r}\lesssim \frac{\pi}{2}\frac{1}{9} \approx \frac{1}{5.7}\]</span> or <span class="math display">\[5.7 \lesssim \frac{r}{R}\lesssim 11.4.\]</span></p></li>
<li><p>Density of the Gas Giant</p>
<p>The density of gas giants in solar system ranges from <span class="math inline">\(687\)</span> to <span class="math inline">\(1640\)</span> <span class="math inline">\(kg/m^3\)</span>. Using them as our reference, we have</p>
<p><span class="math display">\[0.41 \text{ h} \lt \sqrt{\frac{3}{4\pi G \rho}} \lt 0.634 \text{ h}\]</span></p></li>
</ul>
<p>Plugging in our estimations for the density <span class="math inline">\(\rho\)</span> and <span class="math inline">\(R/r\)</span>, we then have the orbital period of Pandora around the gas giant: <span class="math display">\[ 19 \text{ h}\lesssim T=2\pi \sqrt{\frac{r^3}{R^3}}\sqrt{\frac{3}{4\pi G \rho}} \lesssim 153 \text{ h}\]</span></p>
</section>
<section id="eclipse-duration" class="level1">
<h1>Eclipse Duration</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2022/eclipse.svg" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>With the simplest assumption that Pandora’s orbit plane lines up with the gas giant’s orbit plane around its sun, Pandora will pass through the whole diameter of the gas giant’s shadow. We can also assume that the shadow size is almost the same as the size of the gas giant itself (some reasoning and justification about this are given in the <a href="#appendix">Appendix</a>). That means the eclipse duration is the amount of time Pandora spends traveling through the part of the orbit that’s covered in the shadow, the distance of which we approximate as <span class="math inline">\(2R\)</span>: <span class="math display">\[t_{eclipse} = \frac{l}{2\pi r} T \approx \frac{2R}{2\pi r} T = 2 \sqrt{\frac{r}{R}}\sqrt{\frac{3}{4\pi G \rho}}\]</span></p>
<p>Plugging in the ranges of values for density and <span class="math inline">\(R/r\)</span>, we get <span class="math display">\[1.6 \text{ h} \lesssim t_{eclipse} \lesssim 4.3 \text{ h}\]</span></p>
<p>This seems a reasonable amount of time for the actions that happened during the eclipse in the movie.</p>
</section>
<section id="information-on-astronomy-of-pandora" class="level1">
<h1>Information on Astronomy of Pandora</h1>
<p>I later searched online about the world building of Pandora, and found that there’s actually a good amount of information about the astronomy of the system. For example, the <a href="https://james-camerons-avatar.fandom.com/wiki/Alpha_Centauri_System">Alpha_Centauri_System</a>, the <a href="https://james-camerons-avatar.fandom.com/wiki/Pandora#Day-Night_Cycle">Day-Night Cycle</a> of Pandora, and some information about the gas giant <a href="https://james-camerons-avatar.fandom.com/wiki/Polyphemus">Polyphemus</a> where it’s mentioned that the gas giant is “slightly smaller and denser than Jupiter”.</p>
<p>With that information, we can change our lower estimate of the gas giant’s density to <span class="math inline">\(\rho=1330 kg/m^3\)</span>, which updates the upper limit of the orbital period to <span class="math display">\[T \lesssim 110 \text{ h}\]</span> and the upper limit for eclipse time to <span class="math display">\[t_{eclipse} \lesssim 3 \text{ h}\]</span></p>
</section>
<section id="rotation-of-pandora" class="level1">
<h1>Rotation of Pandora</h1>
<p>If Pandora is like the moons of Jupiter, than it will be tidal-locked, and rotates synchronously, with the day equals the period of its orbit around the gas giant. From our estimation of the period <span class="math inline">\(T\)</span>, we have the day on Pandora is between <strong>19</strong> and <strong>110</strong> hours. The lower end of this estimation is probably more realistic.</p>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<section id="shadow-size-of-the-gas-giant" class="level2">
<h2 class="anchored" data-anchor-id="shadow-size-of-the-gas-giant">Shadow Size of the Gas Giant</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2022/shadow_length.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<p>If the sun for the gas giant and Pandora have a similar apparent size in the sky as our sun, then the ratio of its radius <span class="math inline">\(R_s\)</span> to its distance <span class="math inline">\(D\)</span> is about: <span class="math display">\[\frac{R_s}{D}\approx\tan(0.53^{\circ}) \approx \frac{1}{100}\]</span></p>
<p>With similar triangles, we have <span class="math display">\[d = \frac{DR}{R_s-R} \approx \frac{100R_sR}{R_s-R}\]</span></p>
<p>We now do an order-of-magnitude estimation. Assuming that the sun is at least about 10 times bigger than the gas giant (you can get to this conclusion by looking up the size of Jupiter, our sun, Alpha Centauri A and use the fact that the gas giant here is smaller than Jupiter), we have <span class="math inline">\(R_s/(R_s-R)\approx 1\)</span> and <span class="math display">\[d \approx 100R \]</span></p>
<p>Using similar triangles again, we have the shadow radius <span class="math display">\[R_{shadow} = (d-r)R/d \]</span></p>
<p>We’ve estimated that Pandora’s orbit radius around the gas giant <span class="math inline">\(r \lesssim 11.4 R\)</span>, an order of magnitude less than <span class="math inline">\(d\)</span>, so the shadow radius <span class="math display">\[R_{shadow} \approx R\]</span></p>


<div class="sharethis-inline-share-buttons pt-5">

</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/feynlee\.github\.io\/curiosity-notes");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<script src="https://giscus.app/client.js" data-repo="feynlee/curiosity-notes" data-repo-id="MDEwOlJlcG9zaXRvcnkyNDgwOTkxNzg=" data-category="Announcements" data-category-id="DIC_kwDODsmxas4CR7S3" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>